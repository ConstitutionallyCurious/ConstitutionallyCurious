<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>The Constitution</title>
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Montserrat:wght=700&family=Playfair+Display:wght=700&family=Jacquard+24&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0&display=swap"/> 
  <style> 
    /* ===== Overall Theme Variables ===== */
    :root {
      --body-bg: #f9f9f9;
      --card-bg: #fff;
      --primary: #004080;
      --primary-dark: #002f5f;
      --text-main: #333333;
      --accent: #004080;
      --shadow: 0 2px 6px rgba(0, 64, 128, 0.12);
      --border-radius: 8px;
      --highlight-bg: #ffe066;
      --taskbar-bg: #e0e0e0;
      --input-hover-bg: #f3f8ff;
      --toolbar-padding: 8px 16px;
      --toolbar-gap: 14px;
    }

    /* ===== Base ===== */
    html, body {
      background: var(--body-bg);
      color: var(--text-main);
      font-family: 'Roboto', Arial, sans-serif;
      margin: 0;
      padding: 0;
      line-height: 1.65;
      box-sizing: border-box;
      min-height: 100%;
      width: 100%;
      overflow-x: hidden;
      transition: background 0.3s;
    }

    /* ===== Intro Screen ===== */
    #intro-mask {
      position: fixed;
      z-index: 49999;
      inset: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(60, 60, 60, 0.55);
      pointer-events: none;
      transition: opacity 0.6s;
    }
    #intro-mask.hide {
      opacity: 0;
      pointer-events: none;
    }
    #intro-screen {
      position: fixed;
      z-index: 50000 !important;
      left: 50%;
      top: 50%;
      width: 985px; /* This width will be responsive with the new viewport meta */
      height: 680px; /* This height will be responsive with the new viewport meta */
      max-width: 98vw;
      max-height: 98vh;
      transform: translate(-50%, -50%);
      box-shadow: 0 6px 32px rgba(0,0,0,0.25);
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      background: #000;
      border-radius: 18px;
      overflow: hidden;
      transition: opacity 0.6s;
    }
    #intro-screen.hide {
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.7s;
    }
    #intro-video-wrapper {
      position: absolute;
      top: 0; left: 0; width: 100%; height: 100%;
      overflow: hidden;
      z-index: 1;
      background: #000;
      display: flex; align-items: stretch; justify-content: stretch;
    }
    #intro-video {
      width: 100%;
      height: 100%;
      object-fit: cover;
      object-position: center center;
      display: block;
      min-width: 0;
      min-height: 0;
      background: #000;
      border: none;
    }
    #intro-content {
      position: absolute;
      z-index: 2;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-direction: column;
      pointer-events: none;
    }
    #lets-go-btn {
      pointer-events: auto;
      font-family: 'Montserrat', Arial, sans-serif;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 2px;
      font-size: 1.1rem;
      border: none;
      border-radius: 5px;
      background: var(--primary);
      color: #fff;
      padding: 14px 32px;
      cursor: pointer;
      margin-top: 0;
      box-shadow: 0 2px 8px rgba(0,0,0,0.09);
      transition: background 0.2s, color 0.2s, transform 0.1s;
      outline: none;
      position: relative;
      z-index: 3;
    }
    #lets-go-btn:active, #lets-go-btn:focus {
      background: var(--primary-dark);
    }

    /* ===== Topbar Navigation ===== */
    .topbar-nav {
      position: sticky;
      top: 0;
      left: 0;
      width: 100%;
      z-index: 9999;
      background: var(--taskbar-bg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.09);
      padding: var(--toolbar-padding);
      display: flex;
      align-items: center;
      justify-content: center; /* Default to center for larger screens */
      gap: var(--toolbar-gap);
      border-radius: 0;
      flex-wrap: wrap; /* Allow wrapping on smaller screens */
      position: relative; /* For positioning mobile menu */
    }

    /* Styles for the hamburger button (hidden by default) */
    .hamburger-menu {
      display: none; /* Hidden on large screens */
      background: transparent;
      border: none;
      cursor: pointer;
      padding: 0;
      margin: 0;
      color: var(--primary);
    }
    .hamburger-menu .material-symbols-outlined {
      font-size: 28px; /* Larger icon for mobile */
    }

    /* Wrapper for navigation items (flex by default for desktop) */
    .nav-items-wrapper {
      display: flex; /* Always flex on desktop */
      align-items: center;
      justify-content: center;
      gap: var(--toolbar-gap);
      flex-wrap: wrap; /* Allows items to wrap if needed on desktop */
      width: auto; /* Allow content to dictate width */
    }

    .toolbar-item,
    .interpretation-container, /* Changed from .interpretation-toggle to .interpretation-container */
    .jump-dropdown-btn {
      background: var(--card-bg);
      border: 1px solid var(--primary);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 6px 12px;
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 15px;
      color: var(--primary);
      transition: background 0.2s, box-shadow 0.2s, border-color 0.2s;
      outline: none;
    }

    .toolbar-item:focus,
    .toolbar-item:hover,
    .interpretation-container:hover, /* Changed from .interpretation-toggle:hover */
    .interpretation-container:focus, /* Changed from .interpretation-toggle:focus */
    .jump-dropdown-btn:hover,
    .jump-dropdown-btn:focus {
      background: var(--input-hover-bg);
      box-shadow: 0 4px 12px rgba(0, 64, 128, 0.15);
      border-color: var(--primary-dark);
    }

    .search-bar {
      border: none;
      background: transparent;
      width: 180px;
      font-size: 15px;
      color: var(--primary);
      outline: none;
      padding-left: 8px;
    }

    .material-symbols-outlined {
      font-family: 'Material Symbols Outlined' !important;
      font-size: 22px;
      font-variation-settings: 'FILL' 1, 'wght' 400, 'GRAD' 0, 'opsz' 22;
      line-height: 1;
      vertical-align: middle;
      color: var(--primary);
      letter-spacing: normal;
      font-style: normal;
      font-weight: normal;
      display: inline-block;
    }
    /* Icons - consistent sizing */
    .icon-search,
    .icon-translate,
    .icon-article {
      width: 22px;
      height: 22px;
      vertical-align: middle;
      display: inline-block;
    }
    .dropdown-icon { /* For the expand_more icon in the dropdown */
      font-size: 22px !important;
      width: 22px !important;
      height: 22px !important;
    }

    /* ===== Interpretation Toggle (UPDATED STYLES) ===== */
    .interpretation-container {
      position: relative;
      cursor: default; /* Container itself is not a button */
      padding-right: 12px; /* Add space for the toggle */
    }
    .interpretation-container .tooltip {
      visibility: hidden;
      opacity: 0;
      transition: opacity 0.18s;
      position: absolute;
      bottom: 120%;
      left: 50%;
      transform: translateX(-50%);
      background: #333;
      color: #fff;
      border-radius: 6px;
      padding: 8px 12px;
      font-size: 0.96rem;
      white-space: nowrap;
      z-index: 99999;
    }
    .interpretation-container:hover .tooltip,
    .interpretation-container:focus-within .tooltip { /* Use focus-within for accessibility */
      visibility: visible;
      opacity: 1;
    }

    /* Style for the actual toggle switch */
    .interpretation-switch {
      position: relative;
      display: inline-block;
      width: 34px; /* Width of the switch */
      height: 20px; /* Height of the switch */
      margin-left: auto; /* Push to the right */
      flex-shrink: 0; /* Prevent shrinking */
      cursor: pointer;
    }
    .interpretation-switch input {
      opacity: 0;
      width: 0;
      height: 0;
    }
    .interpretation-slider {
      position: absolute;
      cursor: pointer;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      background-color: #ccc;
      transition: .4s;
      border-radius: 20px; /* Rounded slider */
    }
    .interpretation-slider:before {
      position: absolute;
      content: "";
      height: 16px;
      width: 16px;
      left: 2px;
      bottom: 2px;
      background-color: white;
      transition: .4s;
      border-radius: 50%; /* Circular handle */
    }
    .interpretation-switch input:checked + .interpretation-slider {
      background-color: var(--primary);
    }
    .interpretation-switch input:focus + .interpretation-slider {
      box-shadow: 0 0 1px var(--primary);
    }
    .interpretation-switch input:checked + .interpretation-slider:before {
      transform: translateX(14px); /* Move handle to the right */
    }

    /* ===== Jump Dropdown (Go to Article) ===== */
    .jump-dropdown {
      position: relative;
      display: inline-block;
      font-size: 15px;
      cursor: pointer;
    }
    .jump-dropdown-btn {
      background: var(--card-bg);
      color: var(--primary);
      border: 1px solid var(--primary);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      padding: 6px 16px 6px 10px;
      font-size: 15px;
      font-weight: bold;
      display: flex;
      align-items: center;
      gap: 6px;
      cursor: pointer;
      transition: background 0.2s, box-shadow 0.2s, border-color 0.2s, color 0.2s;
      outline: none;
    }
    .jump-dropdown-btn:hover, .jump-dropdown-btn:focus {
      background: var(--input-hover-bg);
      box-shadow: 0 4px 12px rgba(0, 64, 128, 0.18);
      border-color: var(--primary-dark);
      color: var(--primary-dark);
    }
    .jump-dropdown-list {
      display: none;
      position: absolute;
      left: 0;
      top: 110%;
      background: var(--card-bg);
      min-width: 180px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.10);
      border-radius: var(--border-radius);
      border: 1px solid var(--primary);
      z-index: 9999;
      padding: 6px 0;
      margin: 0;
      list-style: none;
      font-family: 'Roboto', Arial, sans-serif;
    }
    .jump-dropdown.open .jump-dropdown-list {
      display: block;
    }
    .jump-dropdown-list li {
      margin: 0;
      padding: 0;
    }
    .jump-dropdown-list a {
      display: block;
      padding: 0.6em 1.2em;
      color: var(--text-main);
      text-decoration: none;
      font-size: 15px;
      border-radius: 0;
      transition: background 0.18s;
    }
    .jump-dropdown-list a:hover, .jump-dropdown-list a:focus {
      background: var(--primary);
      color: #fff;
    }

    /* ===== Main Content ===== */
    .main-content {
      flex: 1 1 auto;
      max-width: 900px;
      margin: 0 auto;
      padding: 2.5rem 2rem 3rem 2rem;
      display: flex;
      flex-direction: column;
      width: 100%;
      box-sizing: border-box;
    }
    .card {
      background: var(--card-bg);
      padding: 1.5rem;
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
      margin-bottom: 2rem;
      width: 100%;
      box-sizing: border-box;
    }

    /* ===== Typography ===== */
    .wethepeople { font-family: 'WeThePeople', cursive; font-size: 3.0em; }
    @font-face {
      font-family: 'WeThePeople';
      src: url('fonts/WeThePeople.ttf') format('truetype');
      font-weight: bold;
      font-style: normal;
    }
    h1, .wethepeople { font-family: 'WeThePeople', cursive; font-size: 2.5rem; }
    h2 { font-family: 'Playfair Display', serif; font-size: 2rem; margin-top: 2.5rem; }
    h3 { font-family: 'Playfair Display', serif; font-size: 1.4rem; margin-top: 1.7rem; }
    p { font-size: 1.125rem; }
    .card h2, .card h3, .card h4, .card h5 { font-family: 'Playfair Display', serif; }

    .interpretation {
      font-size: 1rem;
      color: #666;
      display: block;
      margin-top: 0.5em;
      margin-bottom: 1em;
      font-style: italic;
    }

    /* ===== Amendment XIII Portraits ===== */
    .amendment-xiii-header {
      display: flex;
      align-items: flex-start;
      margin-bottom: 0.5em;
      gap: 12px;
    }
    .amendment-xiii-portraits {
      display: flex;
      align-items: flex-end;
      margin-left: auto;
      gap: 18px;
    }
    .amendment-xiii-person {
      width: 120px;
      height: 160px;
      object-fit: contain;
      background: none;
      border-radius: 0;
      margin: 0;
      box-shadow: none;
    }

    /* ===== Tooltip for Tidbit ===== */
    .tidbit-tooltip-wrapper {
      position: relative;
      display: inline-block;
      cursor: pointer;
      vertical-align: baseline;
      z-index: 0 !important;
    }
    .tidbit-tooltip-box {
      display: none;
      position: fixed !important;
      left: 0; top: 0;
      z-index: 2147483647 !important;
      width: 270px;
      min-width: 200px;
      background: #fff;
      color: #222;
      border: 1px solid #888;
      border-radius: 8px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.12);
      padding: 16px;
      font-size: 16px;
      transition: opacity 0.15s;
      opacity: 0;
      pointer-events: auto;
      flex-direction: column;
      align-items: center;
    }
    .tidbit-tooltip-wrapper.tooltip-visible .tidbit-tooltip-box {
      display: flex !important;
      opacity: 1 !important;
      pointer-events: auto !important;
      visibility: visible !important;
    }
    .tidbit-tooltip-img { width: 100%; height: 96px; object-fit: cover; border-radius: 6px; margin-bottom: 6px; }
    .tidbit-tooltip-btn {
      background: var(--primary);
      color: #fff;
      border: none;
      border-radius: 4px;
      padding: 6px 18px;
      font-size: 15px;
      cursor: pointer;
      margin-top: 6px;
      transition: background 0.2s, color 0.2s;
      text-decoration: none;
      display: inline-block;
      font-family: 'Roboto', Arial, sans-serif;
      font-weight: 700;
    }
    .tidbit-tooltip-btn:hover {
      background: var(--primary-dark);
      color: #fff;
    }
    .tidbit-tooltip-trigger { border-bottom: 2px dotted #333; outline: none; }

    /* ===== Search Highlight ===== */
    mark.search-highlight {
      background: var(--highlight-bg);
      color: inherit;
      padding: 0;
      border-radius: 3px;
    }

    /* ===== Footer ===== */
    .footer {
      margin-top: 40px;
      padding: 24px 0 0 0;
      text-align: center;
      color: #888;
      font-size: 1rem;
    }

    /* ===== Responsive (UPDATED MEDIA QUERIES) ===== */

    /* Tablet/iPad-level (768px to 991px) - Horizontal, smaller buttons */
    @media (min-width: 768px) and (max-width: 991px) {
      .topbar-nav {
        justify-content: space-around; /* Distribute items */
        padding: 6px 10px; /* Slightly less padding */
        gap: 8px; /* Reduced gap */
      }
      .nav-items-wrapper {
        justify-content: center; /* Center items within wrapper */
        flex-grow: 1; /* Allow wrapper to take available space */
      }
      .toolbar-item,
      .interpretation-container, /* Apply to container */
      .jump-dropdown-btn {
        padding: 4px 8px; /* Smaller padding */
        font-size: 14px; /* Smaller font */
        gap: 6px; /* Smaller gap */
      }
      .material-symbols-outlined, .icon-search, .icon-translate, .icon-article, .dropdown-icon {
        font-size: 18px !important; /* Smaller icons */
        width: 18px !important; /* Match icon size */
        height: 18px !important; /* Match icon size */
      }
      .search-bar {
        width: 120px; /* Smaller search bar */
        font-size: 14px;
      }
      .jump-dropdown-list {
        min-width: 150px; /* Adjust dropdown menu width */
        font-size: 0.9em;
      }
      /* Ensure Google Translate widget scales down if it doesn't fit */
      #google_translate_element {
        transform: scale(0.9);
        transform-origin: left center;
        white-space: nowrap;
        margin-left: -5px; /* Adjust for scale */
      }
      /* Adjust interpretation switch for tablet */
      .interpretation-switch {
        width: 30px;
        height: 18px;
      }
      .interpretation-slider:before {
        height: 14px;
        width: 14px;
      }
      .interpretation-switch input:checked + .interpretation-slider:before {
        transform: translateX(12px);
      }
    }

    /* Mobile (iPhone-level, up to 767px) - Hamburger menu */
    @media (max-width: 767px) {
      .topbar-nav {
        flex-direction: row; /* Keep row for hamburger and potential title */
        justify-content: space-between; /* Hamburger to one side, perhaps title to other */
        padding: 8px 16px;
        align-items: center; /* Align items vertically */
      }

      .hamburger-menu {
        display: block; /* Show hamburger icon */
      }

      .nav-items-wrapper {
        display: none; /* Hide nav items by default */
        flex-direction: column; /* Stack items vertically */
        position: absolute; /* Position relative to topbar-nav */
        top: 100%; /* Below the topbar */
        left: 0;
        width: 100%;
        background: var(--taskbar-bg); /* Match topbar background */
        box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        padding: 10px 0;
        border-top: 1px solid rgba(0,0,0,0.1);
        z-index: 999; /* Ensure it's above content */
        box-sizing: border-box; /* Include padding/border in width calculation */
      }

      .nav-items-wrapper.active {
        display: flex; /* Show when active */
      }

      .toolbar-item,
      .interpretation-container, /* Target the container */
      .jump-dropdown, /* Target the dropdown container */
      #google_translate_element {
        width: calc(100% - 32px); /* Full width minus 16px padding on each side */
        margin: 4px 16px; /* Center with padding */
        box-sizing: border-box; /* Include padding/border in width */
        font-size: 16px; /* Slightly larger font for readability */
        padding: 10px 12px; /* More padding for tap targets */
      }
      .search-bar {
        width: 100%; /* Occupy full width of its parent toolbar-item */
      }
      .jump-dropdown-list {
        position: static; /* Within the flow of the menu */
        width: auto; /* Adjust to content */
        max-height: 250px; /* If too many items */
        overflow-y: auto;
        border: none;
        box-shadow: none;
        padding: 0;
        margin: 8px 0; /* Add some vertical spacing */
      }
      .jump-dropdown-list a {
        padding: 10px 20px; /* Larger tap target */
        font-size: 16px;
      }

      /* Adjust general main content padding for very thin screens */
      .main-content {
        padding: 1rem 0.8rem;
      }
    }
  </style> 
</head>
<body>
  <div id="intro-mask"></div>
  <div id="intro-screen">
    <div id="intro-video-wrapper">
      <video id="intro-video" autoplay loop muted playsinline>
        <source src="Introductory screen.mp4" type="video/mp4">
        Your browser does not support the video tag.
      </video>
    </div>
    <div id="intro-content">
      <button id="lets-go-btn">Let's Go!</button>
    </div>
  </div>
  <nav class="topbar-nav" aria-label="Main Navigation">
    <button class="hamburger-menu" aria-label="Open navigation menu" aria-expanded="false">
        <span class="material-symbols-outlined">menu</span>
    </button>

    <div class="nav-items-wrapper">
        <form class="toolbar-item" id="site-search-form" autocomplete="off" role="search">
            <img src="Search.svg" alt="Search" class="icon-search" aria-hidden="true" width="22" height="22" />
            <input class="search-bar" type="search" id="site-search" placeholder="Search the Constitution..." aria-label="Search the Constitution" autocomplete="off">
        </form>

        <div class="interpretation-container" id="interpretation-container" tabindex="0">
            <img src="Translate.svg" alt="Interpretation" class="icon-translate" aria-hidden="true" width="22" height="22" />
            <span>Interpretation</span>
            <label class="interpretation-switch">
                <input type="checkbox" id="interpretation-toggle" checked aria-label="Toggle interpretation display">
                <span class="interpretation-slider"></span>
            </label>
            <span class="tooltip">Show a summarized plain-English version!</span>
        </div>

        <div id="google_translate_element"></div>

        <div class="jump-dropdown" id="articleDropdown">
            <button class="jump-dropdown-btn" type="button" aria-haspopup="true" aria-expanded="false" aria-label="Go to Article or Amendment">
                <img src="Article.svg" alt="Go to Article" class="icon-article" aria-hidden="true" width="22" height="22" />
                Go to Article
                <span class="material-symbols-outlined dropdown-icon">expand_more</span>
            </button>
            <ul class="jump-dropdown-list" role="menu" aria-labelledby="articleDropdown">
                </ul>
        </div>
    </div>
  </nav>

  <div class="main-content">
    <section class="card" id="preamble">
      <p>
        <span class="tidbit-tooltip-wrapper" style="display: inline;">
          <span 
            class="tidbit-tooltip-trigger wethepeople"
            tabindex="0"
            style="border-bottom: 2px dotted #333; cursor: pointer; background: transparent; position: relative;"
            aria-label="Tooltip about 'We the People'"
          >
            We the People
            <span style="
                position: absolute;
                left: 0; top: 0; width: 100%; height: 100%;
                visibility: hidden;
                pointer-events: none;
                user-select: none;">
              We the People
            </span>
          </span>
          <span class="tidbit-tooltip-box" role="tooltip">
            <img class="tidbit-tooltip-img" src="https://upload.wikimedia.org/wikipedia/commons/e/ea/We_the_people_~.jpg" alt="We the People image">
            <span class="tidbit-tooltip-text">‘We the People’ has long aspired to include all Americans, though it hasn’t always lived up to that ideal...</span>
            <a class="tidbit-tooltip-btn btn-bottom" href="https://constitutech.weebly.com/blog/who-exactly-are-we-the-people" target="_blank">Learn More</a>
          </span>
        </span>
        of the United States, in Order to form a more perfect Union...
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
    </section>
    <section class="card" id="article-i">
      <h2>Article I</h2>
      <p>
        To regulate Commerce with foreign Nations, and among the several States, and with the Indian Tribes;
        <span class="tidbit-tooltip-wrapper">
          <span class="tidbit-tooltip-trigger" tabindex="0"><b><u>Naturalization,</u></b></span>
          <span class="tidbit-tooltip-box" role="tooltip">
            <img class="tidbit-tooltip-img" src="https://upload.wikimedia.org/wikipedia/commons/9/9e/Johnadamsvp.flipped.jpg" alt="Tid-bit image">
            <span class="tidbit-tooltip-text">Since 1798 Congress has used this clause in the past to target and deport immigrants based solely on their race or political opinion during times of war or national crisis.</span>
            <a class="tidbit-tooltip-btn btn-bottom" href="https://constitutionallycurious.weebly.com/blog/immigration-the-constitution" target="_blank">Learn More</a>
          </span>
        </span>
        and uniform Laws on the subject of Bankruptcies throughout the United States;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 1</h3>
      <p>
        All legislative Powers herein granted shall be vested in a Congress of the United States, which shall consist of a Senate and House of Representatives.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 2</h3>
      <p>
        The House of Representatives shall be composed of Members chosen every second Year by the People of the several States, and the Electors in each State shall have the Qualifications requisite for Electors of the most numerous Branch of the State Legislature.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Person shall be a Representative who shall not have attained to the Age of twenty five Years, and been seven Years a Citizen of the United States, and who shall not, when elected, be an Inhabitant of that State in which he shall be chosen.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Representatives and direct Taxes shall be apportioned among the several States which may be included within this Union, according to their respective Numbers, which shall be determined by adding to the whole Number of free Persons, including those bound to Service for a Term of Years, and excluding Indians not taxed, three fifths of all other Persons. The actual Enumeration shall be made within three Years after the first Meeting of the Congress of the United States, and within every subsequent Term of ten Years, in such Manner as they shall by Law direct. The Number of Representatives shall not exceed one for every thirty Thousand, but each State shall have at Least one Representative; and until such enumeration shall be made, the State of New Hampshire shall be entitled to chuse three, Massachusetts eight, Rhode Island and Providence Plantations one, Connecticut five, New-York six, New Jersey four, Pennsylvania eight, Delaware one, Maryland six, Virginia ten, North Carolina five, South Carolina five, and Georgia three.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        When vacancies happen in the Representation from any State, the Executive Authority thereof shall issue Writs of Election to fill such Vacancies.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The House of Representatives shall chuse their Speaker and other Officers; and shall have the sole Power of Impeachment.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 3</h3>
      <p>
        The Senate of the United States shall be composed of two Senators from each State, chosen by the Legislature thereof, for six Years; and each Senator shall have one Vote.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Immediately after they shall be assembled in Consequence of the first Election, they shall be divided as equally as may be into three Classes. The Seats of the Senators of the first Class shall be vacated at the Expiration of the second Year, of the second Class at the Expiration of the fourth Year, and of the third Class at the Expiration of the sixth Year, so that one third may be chosen every second Year; and if Vacancies happen by Resignation, or otherwise, during the Recess of the Legislature of any State, the Executive thereof may make temporary Appointments until the next Meeting of the Legislature, which shall then fill such Vacancies.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Person shall be a Senator who shall not have attained to the Age of thirty Years, and been nine Years a Citizen of the United States, and who shall not, when elected, be an Inhabitant of that State for which he shall be chosen.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The Vice President of the United States shall be President of the Senate, but shall have no Vote, unless they be equally divided.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The Senate shall chuse their other Officers, and also a President pro tempore, in the Absence of the Vice President, or when he shall exercise the Office of President of the United States.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The Senate shall have the sole Power to try all Impeachments. When sitting for that Purpose, they shall be on Oath or Affirmation. When the President of the United States is tried, the Chief Justice shall preside: And no Person shall be convicted without the Concurrence of two thirds of the Members present.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Judgment in Cases of Impeachment shall not extend further than to removal from Office, and disqualification to hold and enjoy any Office of honor, Trust or Profit under the United States: but the Party convicted shall nevertheless be liable and subject to Indictment, Trial, Judgment and Punishment, according to Law.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 4</h3>
      <p>
        The Times, Places and Manner of holding Elections for Senators and Representatives, shall be prescribed in each State by the Legislature thereof; but the Congress may at any time by Law make or alter such Regulations, except as to the Places of chusing Senators.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The Congress shall assemble at least once in every Year, and such Meeting shall be on the first Monday in December, unless they shall by Law appoint a different Day.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 5</h3>
      <p>
        Each House shall be the Judge of the Elections, Returns and Qualifications of its own Members, and a Majority of each shall constitute a Quorum to do Business; but a smaller Number may adjourn from day to day, and may be authorized to compel the Attendance of absent Members, in such Manner, and under such Penalties as each House may provide.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Each House may determine the Rules of its Proceedings, punish its Members for disorderly Behaviour, and, with the Concurrence of two thirds, expel a Member.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Each House shall keep a Journal of its Proceedings, and from time to time publish the same, excepting such Parts as may in their Judgment require Secrecy; and the Yeas and Nays of the Members of either House on any question shall, at the Desire of one fifth of those Present, be entered on the Journal.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Neither House, during the Session of Congress, shall, without the Consent of the other, adjourn for more than three days, nor to any other Place than that in which the two Houses shall be sitting.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 6</h3>
      <p>
        The Senators and Representatives shall receive a Compensation for their Services, to be ascertained by Law, and paid out of the Treasury of the United States. They shall in all Cases, except Treason, Felony and Breach of the Peace, be privileged from Arrest during their Attendance at the Session of their respective Houses, and in going to and returning from the same; and for any Speech or Debate in either House, they shall not be questioned in any other Place.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Senator or Representative shall, during the Time for which he was elected, be appointed to any civil Office under the Authority of the United States, which shall have been created, or the Emoluments whereof shall have been encreased during such time; and no Person holding any Office under the United States, shall be a Member of either House during his Continuance in Office.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 7</h3>
      <p>
        All Bills for raising Revenue shall originate in the House of Representatives; but the Senate may propose or concur with Amendments as on other Bills.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Every Bill which shall have passed the House of Representatives and the Senate, shall, before it become a Law, be presented to the President of the United States; If he approve he shall sign it, but if not he shall return it, with his Objections to that House in which it shall have originated, who shall enter the Objections at large on their Journal, and proceed to reconsider it. If after such Reconsideration two thirds of that House shall agree to pass the Bill, it shall be sent, together with the Objections, to the other House, by which it shall likewise be reconsidered, and if approved by two thirds of that House, it shall become a Law. But in all such Cases the Votes of both Houses shall be determined by yeas and Nays, and the Names of the Persons voting for and against the Bill shall be entered on the Journal of each House respectively. If any Bill shall not be returned by the President within ten Days (Sundays excepted) after it shall have been presented to him, the Same shall be a Law, in like Manner as if he had signed it, unless the Congress by their Adjournment prevent its Return, in which Case it shall not be a Law.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        Every Order, Resolution, or Vote to which the Concurrence of the Senate and House of Representatives may be necessary (except on a question of Adjournment) shall be presented to the President of the United States; and before the Same shall take Effect, shall be approved by him, or being disapproved by him, shall be repassed by two thirds of the Senate and House of Representatives, according to the Rules and Limitations prescribed in the Case of a Bill.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 8</h3>
      <p>
        The Congress shall have Power To lay and collect Taxes, Duties, Imposts and Excises, to pay the Debts and provide for the common Defence and general Welfare of the United States; but all Duties, Imposts and Excises shall be uniform throughout the United States;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To borrow Money on the credit of the United States;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To regulate Commerce with foreign Nations, and among the several States, and with the Indian Tribes;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To establish an uniform Rule of Naturalization, and uniform Laws on the subject of Bankruptcies throughout the United States;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To coin Money, regulate the Value thereof, and of foreign Coin, and fix the Standard of Weights and Measures;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To provide for the Punishment of counterfeiting the Securities and current Coin of the United States;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To establish Post Offices and post Roads;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To promote the Progress of Science and useful Arts, by securing for limited Times to Authors and Inventors the exclusive Right to their respective Writings and Discoveries;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To constitute Tribunals inferior to the supreme Court;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To define and punish Piracies and Felonies committed on the high Seas, and Offences against the Law of Nations;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To declare War, grant Letters of Marque and Reprisal, and make Rules concerning Captures on Land and Water;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To raise and support Armies, but no Appropriation of Money to that Use shall be for a longer Term than two Years;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To provide and maintain a Navy;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To make Rules for the Government and Regulation of the land and naval Forces;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To provide for calling forth the Militia to execute the Laws of the Union, suppress Insurrections and repel Invasions;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To provide for organizing, arming, and disciplining, the Militia, and for governing such Part of them as may be employed in the Service of the United States, reserving to the States respectively, the Appointment of the Officers, and the Authority of training the Militia according to the discipline prescribed by Congress;
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To exercise exclusive Legislation in all Cases whatsoever, over such District (not exceeding ten Miles square) as may, by Cession of particular States, and the Acceptance of Congress, become the Seat of Government of the United States, and to exercise like Authority over all Places purchased by the Consent of the Legislature of the State in which the Same shall be, for the Erection of Forts, Magazines, Arsenals, dock-Yards, and other needful Buildings;–And
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        To make all Laws which shall be necessary and proper for carrying into Execution the foregoing Powers, and all other Powers vested by this Constitution in the Government of the United States, or in any Department or Officer thereof.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 9</h3>
      <p>
        The Migration or Importation of such Persons as any of the States now existing shall think proper to admit, shall not be prohibited by the Congress prior to the Year one thousand eight hundred and eight, but a Tax or duty may be imposed on such Importation, not exceeding ten dollars for each Person.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        The Privilege of the Writ of Habeas Corpus shall not be suspended, unless when in Cases of Rebellion or Invasion the public Safety may require it.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Bill of Attainder or ex post facto Law shall be passed.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Capitation, or other direct, Tax shall be laid, unless in Proportion to the Census or enumeration herein before directed to be taken.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Tax or Duty shall be laid on Articles exported from any State.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Preference shall be given by any Regulation of Commerce or Revenue to the Ports of one State over those of another: nor shall Vessels bound to, or from, one State, be obliged to enter, clear, or pay Duties in another.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Money shall be drawn from the Treasury, but in Consequence of Appropriations made by Law; and a regular Statement and Account of the Receipts and Expenditures of all public Money shall be published from time to time.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No Title of Nobility shall be granted by the United States: And no Person holding any Office of Profit or Trust under them, shall, without the Consent of the Congress, accept of any present, Emolument, Office, or Title, of any kind whatever, from any King, Prince, or foreign State.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <h3>Section 10</h3>
      <p>
        No State shall enter into any Treaty, Alliance, or Confederation; grant Letters of Marque and Reprisal; coin Money; emit Bills of Credit; make any Thing but gold and silver Coin a Tender in Payment of Debts; pass any Bill of Attainder, ex post facto Law, or Law impairing the Obligation of Contracts, or grant any Title of Nobility.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No State shall, without the Consent of the Congress, lay any Imposts or Duties on Imports or Exports, except what may be absolutely necessary for executing it's inspection Laws: and the net Produce of all Duties and Imposts, laid by any State on Imports or Exports, shall be for the Use of the Treasury of the United States; and all such Laws shall be subject to the Revision and Controul of the Congress.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
      <p>
        No State shall, without the Consent of Congress, lay any Duty of Tonnage, keep Troops, or Ships of War in time of Peace, enter into any Agreement or Compact with another State, or with a foreign Power, or engage in War, unless actually invaded, or in such imminent Danger as will not admit of delay.
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
    </section>
    <section class="card" id="article-ii">
      <h2>Article II</h2>
      <p>[Your Article II content here]</p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
    </section>
    <section class="card" id="article-iii">
      <h2>Article III</h2>
      <p>[Your Article III content here]</p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
    </section>
    <section class="card" id="amendment-xiii">
      <div class="amendment-xiii-header">
        <h2 style="display:inline-block;vertical-align:middle;margin:0 0 0 10px;">Amendment XIII</h2>
        <div class="amendment-xiii-portraits">
          <img src="harriettubman.png" alt="Harriet Tubman" class="amendment-xiii-person harriettubman">
          <img src="frederickdouglass.png" alt="Frederick Douglass" class="amendment-xiii-person frederickdouglass">
          <img src="abrahamlincoln.png" alt="Abraham Lincoln" class="amendment-xiii-person abrahamlincoln">
        </div>
      </div>
      <p>
        No Person shall be a Senator who shall not have attained to the Age of thirty Years, and been nine Years a Citizen of the United States, and who shall not, when elected, be an Inhabitant of that State for which he shall be chosen;
        <span class="tidbit-tooltip-wrapper">
          <span class="tidbit-tooltip-trigger" tabindex="0"><b><u>involuntary servitude</u></b></span>
          <span class="tidbit-tooltip-box" role="tooltip">
            <img class="tidbit-tooltip-img" src="https://designshack.net/wp-content/uploads/placehold.jpg" alt="Tid-bit image">
            <span class="tidbit-tooltip-text">This is a tid-bit about the Constitution.</span>
            <a class="tidbit-tooltip-btn btn-bottom" href="https://example.com" target="_blank">Learn More</a>
          </span>
        </span>, except as a punishment for crime whereof the party shall have been duly convicted, shall exist within the United States...
      </p>
      <span class="interpretation">[Interpretation for the above paragraph]</span>
    </section>
    <footer class="footer">
      <p>© 2025 Constitutionally Curious</p>
    </footer>
  </div>
  <audio id="tooltip-audio" src="selection.mp3" preload="auto"></audio>
  <script type="text/javascript" src="//translate.google.com/translate_a/element.js?cb=googleTranslateElementInit"></script>
  <script>
    // Google Translate Initialization
    function googleTranslateElementInit() {
      new google.translate.TranslateElement({
        pageLanguage: 'en',
        layout: google.translate.TranslateElement.InlineLayout.SIMPLE,
        includedLanguages: 'af,sq,ar,hy,az,eu,be,bn,bg,ca,zh-CN,zh-TW,hr,cs,da,nl,en,et,tl,fi,fr,gl,ka,de,el,gu,ht,iw,hi,hu,is,id,ga,it,ja,kn,ko,la,lv,lt,mk,ms,mt,no,fa,pl,pt,ro,ru,sr,sk,sl,es,sw,sv,ta,te,th,tr,uk,ur,vi,cy'
      }, 'google_translate_element');
    }

    document.addEventListener('DOMContentLoaded', function() {
      // Intro Screen Logic
      const introScreen = document.getElementById('intro-screen');
      const introMask = document.getElementById('intro-mask');
      const letsGoBtn = document.getElementById('lets-go-btn');
      if (letsGoBtn && introScreen && introMask) {
        letsGoBtn.addEventListener('click', function() {
          introScreen.classList.add('hide');
          introMask.classList.add('hide');
          setTimeout(function() {
            introScreen.style.display = 'none';
            introMask.style.display = 'none';
          }, 750);
        });
        letsGoBtn.addEventListener('keydown', function(e) {
          if (e.key === 'Enter' || e.key === ' ') {
            letsGoBtn.click();
          }
        });
      }

      // Hamburger Menu Logic for Responsive Navigation
      const hamburger = document.querySelector('.hamburger-menu');
      const navItemsWrapper = document.querySelector('.nav-items-wrapper');

      if (hamburger && navItemsWrapper) {
        hamburger.addEventListener('click', function() {
          const isOpen = navItemsWrapper.classList.toggle('active');
          hamburger.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
          // Optionally change icon from 'menu' to 'close'
          hamburger.querySelector('.material-symbols-outlined').textContent = isOpen ? 'close' : 'menu';
        });

        // Close menu when clicking outside
        document.addEventListener('click', function(e) {
          if (!navItemsWrapper.contains(e.target) && !hamburger.contains(e.target) && navItemsWrapper.classList.contains('active')) {
            navItemsWrapper.classList.remove('active');
            hamburger.setAttribute('aria-expanded', 'false');
            hamburger.querySelector('.material-symbols-outlined').textContent = 'menu';
          }
        });

        // Close menu on resize if it's open and larger than mobile breakpoint
        window.addEventListener('resize', function() {
          // Check if the current window width is above the mobile breakpoint (767px)
          if (window.innerWidth > 767 && navItemsWrapper.classList.contains('active')) {
            navItemsWrapper.classList.remove('active');
            hamburger.setAttribute('aria-expanded', 'false');
            hamburger.querySelector('.material-symbols-outlined').textContent = 'menu';
          }
        });
      }

      // Interpretation Toggle Logic (UPDATED)
      const interpretationToggle = document.getElementById('interpretation-toggle'); // This is now the checkbox input
      const interpretations = document.querySelectorAll('.interpretation');
      let interpretationActive = true; // Default to active/visible

      function updateInterpretationsDisplay() {
        const show = interpretationActive;
        interpretations.forEach(el => el.style.display = show ? 'block' : 'none');
      }

      if (interpretationToggle) {
        // Set initial state of the checkbox based on interpretationActive
        interpretationToggle.checked = interpretationActive; 

        interpretationToggle.addEventListener('change', function() { // Listen for 'change' event on the checkbox
          interpretationActive = interpretationToggle.checked; // Update state based on checkbox
          updateInterpretationsDisplay();
          // The aria-pressed attribute is now implicitly handled by the checkbox's checked state
          // For a custom switch, you might still set an aria-checked attribute on the associated label/container
        });
        // Initial state update
        updateInterpretationsDisplay();
      }

      // Go to Article Dropdown Logic
      const articleDropdown = document.getElementById('articleDropdown');
      const jumpDropdownBtn = articleDropdown ? articleDropdown.querySelector('.jump-dropdown-btn') : null;
      const jumpDropdownList = articleDropdown ? articleDropdown.querySelector('.jump-dropdown-list') : null;
      const articleLinks = [
          { text: "Preamble", href: "#preamble" },
          { text: "Article I", href: "#article-i" },
          { text: "Article II", href: "#article-ii" },
          { text: "Article III", href: "#article-iii" },
          { text: "Amendment XIII", href: "#amendment-xiii" }
      ];

      // Populate dropdown
      if (jumpDropdownList) {
          jumpDropdownList.innerHTML = articleLinks.map(link =>
              `<li><a href="${link.href}" role="menuitem">${link.text}</a></li>`
          ).join('');
      }

      // Dropdown toggle
      if (jumpDropdownBtn) {
          jumpDropdownBtn.addEventListener('click', function(e) {
              const isOpen = articleDropdown.classList.toggle('open');
              jumpDropdownBtn.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
              if (isOpen && jumpDropdownList) {
                  jumpDropdownList.focus(); // Focus the list
              }
              e.stopPropagation(); // Prevent document click from immediately closing
          });
      }
      // Close on outside click
      document.addEventListener('click', function(e) {
          if (articleDropdown && !articleDropdown.contains(e.target)) {
              articleDropdown.classList.remove('open');
              if (jumpDropdownBtn) {
                  jumpDropdownBtn.setAttribute('aria-expanded', 'false');
              }
          }
      });
      // Keyboard navigation for dropdown
      if (jumpDropdownList) {
          jumpDropdownList.addEventListener('keydown', function(e) {
              const currentFocus = document.activeElement;
              const items = Array.from(jumpDropdownList.querySelectorAll('a'));
              let index = items.indexOf(currentFocus);

              if (e.key === 'ArrowDown') {
                  e.preventDefault();
                  if (index < items.length - 1) {
                      items[index + 1].focus();
                  } else {
                      items[0].focus(); // Loop to first
                  }
              } else if (e.key === 'ArrowUp') {
                  e.preventDefault();
                  if (index > 0) {
                      items[index - 1].focus();
                  } else {
                      items[items.length - 1].focus(); // Loop to last
                  }
              } else if (e.key === 'Escape') {
                  e.preventDefault();
                  articleDropdown.classList.remove('open');
                  if (jumpDropdownBtn) {
                      jumpDropdownBtn.setAttribute('aria-expanded', 'false');
                      jumpDropdownBtn.focus(); // Return focus to button
                  }
              }
          });
          // Handle clicks on dropdown items
          jumpDropdownList.addEventListener('click', function(e) {
              if (e.target.tagName === 'A') {
                  const targetId = e.target.getAttribute('href').substring(1);
                  const targetElement = document.getElementById(targetId);
                  if (targetElement) {
                      e.preventDefault();
                      targetElement.scrollIntoView({ behavior: 'smooth' });
                      articleDropdown.classList.remove('open');
                      jumpDropdownBtn.setAttribute('aria-expanded', 'false');
                  }
              }
          });
      }

      // Tidbit Tooltip Logic
      const tooltipAudio = document.getElementById('tooltip-audio');
      document.querySelectorAll('.tidbit-tooltip-wrapper').forEach(function(wrapper) {
        let trigger = wrapper.querySelector('.tidbit-tooltip-trigger');
        let tooltip = wrapper.querySelector('.tidbit-tooltip-box');
        let hoverOnTrigger = false;
        let hoverOnTooltip = false;
        let hideTimeout;

        function moveTooltip() {
          if(!tooltip || !trigger) return;
          const rect = trigger.getBoundingClientRect();
          let left = rect.left + rect.width/2 - tooltip.offsetWidth/2;
          let top = rect.bottom + 8;
          if(left < 8) left = 8;
          if(left + tooltip.offsetWidth > window.innerWidth - 8)
            left = window.innerWidth - tooltip.offsetWidth - 8;
          if(top + tooltip.offsetHeight > window.innerHeight - 8)
            top = rect.top - tooltip.offsetHeight - 8;
          if(top < 8) top = 8;
          tooltip.style.left = left + "px";
          tooltip.style.top = top + "px";
        }

        function showTooltip() {
          clearTimeout(hideTimeout);
          wrapper.classList.add('tooltip-visible');
          moveTooltip();
          if(tooltipAudio) {
            tooltipAudio.currentTime = 0;
            tooltipAudio.play().catch(()=>{});
          }
        }

        function hideTooltip() {
          hideTimeout = setTimeout(function() {
            if (!hoverOnTrigger && !hoverOnTooltip) {
              wrapper.classList.remove('tooltip-visible');
            }
          }, 100);
        }

        trigger.addEventListener('mouseenter', function() {
          hoverOnTrigger = true;
          showTooltip();
        });
        trigger.addEventListener('mouseleave', function() {
          hoverOnTrigger = false;
          hideTooltip();
        });
        trigger.addEventListener('focus', function() {
          hoverOnTrigger = true;
          showTooltip();
        });
        trigger.addEventListener('blur', function() {
          hoverOnTrigger = false;
          hideTooltip();
        });
        trigger.addEventListener('mousemove', moveTooltip);
        tooltip.addEventListener('mouseenter', function() {
          hoverOnTooltip = true;
          showTooltip();
        });
        tooltip.addEventListener('mouseleave', function() {
          hoverOnTooltip = false;
          hideTooltip();
        });

        window.addEventListener('scroll', function(){ 
          if(wrapper.classList.contains('tooltip-visible')) moveTooltip();
        }, true);
        window.addEventListener('resize', function(){ 
          if(wrapper.classList.contains('tooltip-visible')) moveTooltip();
        }, true);

        // Click event for accessibility/touch devices
        trigger.addEventListener('click', function(e) {
          if (!isTouchDevice()) return; // Only for touch devices if hover is also enabled
          
          if(wrapper.classList.contains('tooltip-visible')) {
            wrapper.classList.remove('tooltip-visible');
          } else {
            // Close other tooltips when opening a new one
            document.querySelectorAll('.tidbit-tooltip-wrapper.tooltip-visible').forEach(function(other) {
              if(other !== wrapper) other.classList.remove('tooltip-visible');
            });
            wrapper.classList.add('tooltip-visible');
            if(tooltipAudio) {
              tooltipAudio.currentTime = 0;
              tooltipAudio.play().catch(()=>{});
            }
          }
          e.stopPropagation(); // Prevent document click from immediately closing
        });
        // Close tooltip when clicking anywhere else on touch devices
        if (isTouchDevice()) {
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.tidbit-tooltip-wrapper')) {
                    document.querySelectorAll('.tidbit-tooltip-wrapper.tooltip-visible').forEach(function(el){
                        el.classList.remove('tooltip-visible');
                    });
                }
            });
        }
      });
      // Helper to detect touch devices
      function isTouchDevice() {
        return window.matchMedia('(hover: none) and (pointer: coarse)').matches;
      }

      // Search Functionality
      const searchInput = document.getElementById('site-search');
      const searchForm = document.getElementById('site-search-form');
      const cards = Array.from(document.querySelectorAll('.main-content .card'));
      cards.forEach(card => {
        card.setAttribute('data-original-html', card.innerHTML);
      });
      function escapeRegExp(string) {
        return string.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
      }
      function highlightText(node, query) {
        if (!query || !node || node.nodeType !== 1) return;
        Array.from(node.querySelectorAll('mark.search-highlight')).forEach(mark => {
          mark.replaceWith(document.createTextNode(mark.textContent));
        });
        if (!query.trim()) return;
        const walker = document.createTreeWalker(node, NodeFilter.SHOW_TEXT, null, false);
        const ranges = [];
        const regex = new RegExp(escapeRegExp(query), 'gi');
        let textNode;
        while ((textNode = walker.nextNode())) {
          let match;
          let start = 0;
          while ((match = regex.exec(textNode.textContent)) !== null) {
            ranges.push({
              node: textNode,
              start: match.index,
              length: match[0].length
            });
            start = match.index + match[0].length;
          }
        }
        for (let i = ranges.length - 1; i >= 0; i--) {
          const { node, start, length } = ranges[i];
          const span = document.createElement('mark');
          span.className = 'search-highlight';
          span.textContent = node.textContent.substr(start, length);
          const after = node.splitText(start + length);
          const matchNode = node.splitText(start);
          matchNode.parentNode.replaceChild(span, matchNode);
        }
      }
      function clearHighlights(card) {
        card.innerHTML = card.getAttribute('data-original-html');
      }
      function performSearch(q) {
        const query = q.trim().toLowerCase();
        if (!query) {
          cards.forEach(card => {
            card.style.display = '';
            clearHighlights(card);
          });
          return;
        }
        cards.forEach(card => {
          clearHighlights(card);
          const text = card.textContent.toLowerCase();
          if (text.includes(query)) {
            card.style.display = '';
            highlightText(card, q);
          } else {
            card.style.display = 'none';
          }
        });
      }
      searchForm.addEventListener('submit', function(e) {
        e.preventDefault();
        performSearch(searchInput.value);
      });
      searchInput.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          performSearch(searchInput.value);
        } else if (e.key === 'Escape') {
          searchInput.value = '';
          performSearch('');
        }
      });
    });
  </script>
</body>
</html>
