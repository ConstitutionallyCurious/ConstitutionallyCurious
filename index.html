<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>The Constitution</title>
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Playfair+Display:wght@700&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Roboto', Arial, sans-serif;
      background: #f9f9f9;
      color: #333;
      line-height: 1.65;
      margin: 0;
      padding: 0;
    }
    .main-layout { display: flex; }
    .sidebar {
      width: 240px;
      background: #fff;
      border-right: 1px solid #e5e5e5;
      box-shadow: 2px 0 8px 0 rgba(0,0,0,0.02);
      padding: 2rem 1rem 2rem 1.5rem;
      min-height: 100vh;
      position: sticky;
      top: 0;
      z-index: 1001;
    }
    .main-content {
      flex: 1 1 auto;
      max-width: 900px;
      margin: 0 auto;
      padding: 2.5rem 2rem 3rem 2rem;
      display: flex;
      flex-direction: column;
    }
    .card {
      background: #fff;
      padding: 1.5rem;
      border-radius: 8px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
      margin-bottom: 2rem;
    }
    h2 { font-family: 'Playfair Display', serif; font-size: 2rem; }
    .wethepeople { font-family: 'Playfair Display', serif; font-size: 2.5rem; }
    .interpretation { font-size: 1rem; color: #666; font-style: italic; margin-bottom: 1em; }
    /* Tooltip overlay */
    #tidbit-tooltip {
      position: fixed;
      left: 0; top: 0;
      width: 270px;
      z-index: 5000;
      visibility: hidden;
      opacity: 0;
      pointer-events: none;
      background: #fff;
      color: #222;
      border: 1px solid #888;
      border-radius: 8px;
      box-shadow: 0 4px 24px rgba(0,0,0,0.12);
      padding: 16px;
      font-size: 16px;
      display: flex;
      flex-direction: column;
      align-items: center;
      transition: opacity 0.15s;
    }
    #tidbit-tooltip.visible {
      visibility: visible;
      opacity: 1;
      pointer-events: auto;
    }
    #tidbit-tooltip img {
      width: 100%;
      height: 96px;
      object-fit: cover;
      border-radius: 6px;
      margin-bottom: 6px;
    }
    #tidbit-tooltip .tidbit-tooltip-btn {
      background: #a0a0a0; color: white; border: none; border-radius: 4px;
      padding: 6px 18px; font-size: 15px; cursor: pointer; margin-top: 6px;
      transition: background 0.2s; text-decoration: none;
      display: inline-block;
    }
    #tidbit-tooltip .tidbit-tooltip-btn:hover { background: #767676; }
    .tidbit-tooltip-trigger { border-bottom: 2px dotted #333; outline: none; cursor: pointer; }
    /* Hide static tooltip box for accessibility only */
    .tidbit-tooltip-box { display: none !important; }
    @media (max-width: 1000px) {
      .sidebar { display: none; }
      .main-content { padding-left: 1rem; padding-right: 1rem; }
    }
    @media (max-width: 600px) {
      .main-content { padding: 1rem 0.5rem; }
    }
  </style>
</head>
<body>
  <div class="main-layout">
    <nav class="sidebar">
      <ul>
        <li><a href="#preamble">We the People</a></li>
        <li><a href="#article-i">Article I</a></li>
        <li><a href="#amendment-xiii">Amendment XIII</a></li>
      </ul>
    </nav>
    <div class="main-content">
      <section class="card" id="preamble">
        <p>
          <span class="wethepeople">We the People</span> of the United States, in Order to form a more perfect Union...
        </p>
        <span class="interpretation">[Interpretation for the Preamble]</span>
      </section>
      <section class="card" id="article-i">
        <h2>Article I</h2>
        <p>
          To regulate Commerce with foreign Nations, and among the several States, and with the Indian Tribes;
          <span class="tidbit-tooltip-wrapper"
            data-img="https://upload.wikimedia.org/wikipedia/commons/9/9e/Johnadamsvp.flipped.jpg"
            data-text="Since 1798 Congress has used this clause in the past to target and deport immigrants based solely on their race or political opinion during times of war or national crisis."
            data-link="https://constitutionallycurious.weebly.com/blog/immigration-the-constitution"
            data-btn="Learn More"
          >
            <span class="tidbit-tooltip-trigger" tabindex="0"><b><u>Naturalization</u></b></span>
            <!-- The static box is here for accessibility only, never shown -->
            <span class="tidbit-tooltip-box" role="tooltip"></span>
          </span>
          and uniform Laws on the subject of Bankruptcies throughout the United States;
        </p>
      </section>
      <section class="card" id="amendment-xiii">
        <h2>Amendment XIII</h2>
        <p>
          No Person shall be a Senator who shall not have attained to the Age of thirty Years, and been nine Years a Citizen of the United States, and who shall not, when elected, be an Inhabitant of that State for which he shall be chosen;
          <span class="tidbit-tooltip-wrapper"
            data-img="https://designshack.net/wp-content/uploads/placehold.jpg"
            data-text="This is a tid-bit about the Constitution."
            data-link="https://example.com"
            data-btn="Learn More"
          >
            <span class="tidbit-tooltip-trigger" tabindex="0"><b><u>involuntary servitude</u></b></span>
            <span class="tidbit-tooltip-box" role="tooltip"></span>
          </span>
          , except as a punishment for crime whereof the party shall have been duly convicted, shall exist within the United States...
        </p>
        <span class="interpretation">[Interpretation for Amendment XIII]</span>
      </section>
    </div>
  </div>
  <div id="tidbit-tooltip"></div>
  <audio id="tooltip-audio" src="selection.mp3" preload="auto"></audio>
  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const tooltip = document.getElementById('tidbit-tooltip');
      const audio = document.getElementById('tooltip-audio');
      let hideTimeout = null;

      function playTooltipSound() {
        if(audio) {
          audio.currentTime = 0;
          audio.play().catch(()=>{});
        }
      }

      function showTooltipFor(trigger) {
        // Read all data-* attributes
        const wrapper = trigger.closest('.tidbit-tooltip-wrapper');
        if(!wrapper) return;
        const imgSrc = wrapper.getAttribute('data-img');
        const text = wrapper.getAttribute('data-text');
        const link = wrapper.getAttribute('data-link');
        const btn = wrapper.getAttribute('data-btn') || "Learn More";

        tooltip.innerHTML = '';
        if(imgSrc) {
          const img = document.createElement('img');
          img.src = imgSrc;
          img.alt = "";
          tooltip.appendChild(img);
        }
        if(text) {
          const p = document.createElement('p');
          p.textContent = text;
          tooltip.appendChild(p);
        }
        if(link) {
          const a = document.createElement('a');
          a.href = link;
          a.target = "_blank";
          a.className = 'tidbit-tooltip-btn';
          a.textContent = btn;
          tooltip.appendChild(a);
        }

        tooltip.classList.add('visible');

        // Smart positioning
        setTimeout(() => {
          const triggerRect = trigger.getBoundingClientRect();
          const tooltipRect = tooltip.getBoundingClientRect();
          const spacing = 10;
          let top = triggerRect.bottom + spacing;
          let left = triggerRect.left + (triggerRect.width - tooltipRect.width) / 2;
          if(left + tooltipRect.width > window.innerWidth - 8) left = window.innerWidth - tooltipRect.width - 8;
          if(left < 8) left = 8;
          if(top + tooltipRect.height > window.innerHeight - 8) {
            top = triggerRect.top - tooltipRect.height - spacing;
            if(top < 8) top = 8;
          }
          tooltip.style.left = (left + window.scrollX) + "px";
          tooltip.style.top = (top + window.scrollY) + "px";
        }, 0);
      }

      function hideTooltip() {
        tooltip.classList.remove('visible');
        tooltip.style.left = "-9999px";
        tooltip.style.top = "-9999px";
        tooltip.innerHTML = '';
      }

      document.querySelectorAll('.tidbit-tooltip-trigger').forEach(function(trigger){
        trigger.addEventListener('mouseenter', function(){
          clearTimeout(hideTimeout);
          playTooltipSound();
          showTooltipFor(trigger);
        });
        trigger.addEventListener('focus', function(){
          clearTimeout(hideTimeout);
          playTooltipSound();
          showTooltipFor(trigger);
        });
        trigger.addEventListener('mouseleave', function(){
          hideTimeout = setTimeout(hideTooltip, 120);
        });
        trigger.addEventListener('blur', function(){
          hideTimeout = setTimeout(hideTooltip, 120);
        });
        trigger.addEventListener('click', function(e){
          playTooltipSound();
        });
      });
      tooltip.addEventListener('mouseleave', hideTooltip);
      window.addEventListener('scroll', hideTooltip, {passive:true});
      // Mobile tap-to-toggle
      function isTouchDevice() {
        return window.matchMedia('(hover: none) and (pointer: coarse)').matches;
      }
      if(isTouchDevice()) {
        document.querySelectorAll('.tidbit-tooltip-trigger').forEach(function(trigger){
          trigger.addEventListener('click', function(e){
            e.preventDefault();
            playTooltipSound();
            showTooltipFor(trigger);
          });
        });
        document.addEventListener('click', function(e){
          if(!e.target.closest('.tidbit-tooltip-trigger') && !e.target.closest('#tidbit-tooltip')) {
            hideTooltip();
          }
        });
      }
    });
  </script>
</body>
</html>
