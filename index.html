<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Constitution</title>
    <link href="https://fonts.googleapis.com/css2?family=Jacquard+24&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { display: flex; flex-direction: column; font-family: 'Times New Roman', serif; background-color: white; }
        .wrapper { display: flex; flex-direction: column; flex-grow: 1; min-height: 100vh; padding: 20px; }
        .toggle-container { display: flex; justify-content: flex-end; align-items: center; margin-bottom: 20px; }
        .toggle-label { font-size: 18px; font-weight: bold; margin-right: 10px; }
        .toggle-switch { position: relative; width: 50px; height: 25px; background-color: #ccc; border-radius: 25px; cursor: pointer; transition: background-color 0.3s ease-in-out; }
        .toggle-switch:before { content: ''; position: absolute; top: 3px; left: 3px; width: 19px; height: 19px; background-color: white; border-radius: 50%; transition: transform 0.3s ease-in-out; }
        .toggle-switch.active { background-color: #4caf50; }
        .toggle-switch.active:before { transform: translateX(25px); }
        .content h1 { font-size: 32px; font-weight: bold; margin-bottom: 20px; }
        .content h2 { font-size: 28px; font-weight: bold; margin-top: 20px; }
        .content h3 { font-size: 24px; font-weight: bold; margin-top: 15px; }
        .content p { font-size: 18px; margin-bottom: 10px; }
        .interpretation { font-size: 16px; color: gray; display: block; margin-top: 5px; }
        .jacquard { font-family: 'Jacquard 24', cursive; }
        @font-face { font-family: 'WeThePeople'; src: url('fonts/WeThePeople.ttf') format('truetype'); font-weight: bold; font-style: normal; }
        .wethepeople { font-family: 'WeThePeople', cursive; font-size: 3.0em; }
        .tidbit-tooltip-wrapper {
            display: inline;  /* <--- FIXED HERE */
            position: relative;
            cursor: pointer;
        }
        .tidbit-tooltip-box {
            position: fixed;
            z-index: 1000;
            min-width: 250px;
            max-width: 320px;
            min-height: 180px;
            background: #fff;
            border: 1px solid #888;
            border-radius: 8px;
            box-shadow: 0 4px 24px rgba(0,0,0,0.12);
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
            padding: 16px;
            font-size: 16px;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
        }
        .tidbit-tooltip-box.visible { opacity: 1; pointer-events: auto; animation: fadeIn 0.3s; }
        .tidbit-tooltip-img { width: 100%; height: 96px; object-fit: cover; border-radius: 6px; margin-bottom: 6px; flex-shrink: 0; flex-grow: 0; }
        .tidbit-tooltip-text { width: 100%; margin: 0; text-align: center; flex-grow: 0; }
        .tidbit-tooltip-btn { background: #a0a0a0; color: white; border: none; border-radius: 4px; padding: 6px 18px; font-size: 15px; cursor: pointer; margin-top: 6px; transition: background 0.2s; align-self: center; z-index: 1002; }
        .tidbit-tooltip-btn:hover { background: #767676; }
        .btn-top    { order: -1; align-self: center; margin-bottom: 8px; margin-top: 0; }
        .btn-bottom { order: 99; align-self: center; margin-top: 8px; margin-bottom: 0; }
        .btn-left   { order: 1; align-self: flex-start; margin-right: auto; }
        .btn-right  { order: 1; align-self: flex-end; margin-left: auto; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px);} to { opacity: 1; transform: translateY(0);} }
        .tidbit-tooltip-bridge { position: absolute; pointer-events: auto; background: transparent; height: 20px; left: 0; right: 0; top: 100%; z-index: 999; }
        /* Make sure the tooltip box is above the bridge for clicks */
        .tidbit-tooltip-box { z-index: 2000; }
        /* Make sure wrapper has a high z-index too when hovered */
        .tidbit-tooltip-wrapper:hover { z-index: 1500; }
    </style>
</head>
<body>
    <div class="wrapper">
        <!-- Toggle Switch -->
        <div class="toggle-container">
            <span class="toggle-label">Interpretation</span>
            <div class="toggle-switch active"></div>
        </div>
        <!-- Content -->
        <div class="content">
            <p>
                <span class="wethepeople">We the People</span> of the United States, in Order to form a more perfect Union...
            </p>
            <span class="interpretation">[Interpretation for the Preamble]</span>
            <h2>Article I</h2>
            <h3>Section 1 - Legislative Powers</h3>
            <p>All legislative Powers herein granted shall be vested in a Congress of the United States...</p>
            <span class="interpretation">[Interpretation for Section 1]</span>
            <h3>Section 2 - The House of Representatives</h3>
            <p>The House of Representatives shall be composed of Members chosen every second Year...</p>
            <span class="interpretation">[Interpretation for Section 2]</span>
            <h3>Section 3 - The Senate</h3>
            <p>The Senate of the United States shall be composed of two Senators from each State...</p>
            <span class="interpretation">[Interpretation for Section 3]</span>
            <h2>Amendments</h2>
            <h3>Amendment XIII</h3>
            <p>
                Neither slavery nor
                <span class="tidbit-tooltip-wrapper"
                    data-img="https://designshack.net/wp-content/uploads/placehold.jpg"
                    data-text="This is a tid-bit about the Constitution."
                    data-link="https://example.com"
                    data-btn-pos="bottom">
                    <b><u>involuntary servitude</u></b>
                    <div class="tidbit-tooltip-bridge"></div>
                </span>, except as a punishment for crime whereof the party shall have been duly convicted, shall exist within the United States...
            </p>
            <span class="interpretation">[Interpretation for Amendment XIII]</span>
        </div>
    </div>
    <footer class="footer">
        <p>Â© 2025 Constitutionally Curious</p>
    </footer>
    <div id="tidbit-tooltip" class="tidbit-tooltip-box" style="display:none;">
        <img class="tidbit-tooltip-img" src="" alt="Tid-bit image">
        <p class="tidbit-tooltip-text"></p>
        <button class="tidbit-tooltip-btn btn-bottom" tabindex="0">Learn More</button>
    </div>
    <audio id="tooltip-audio" src="selection.mp3" preload="auto"></audio>
    <script>
        // Toggle interpretation visibility
        document.addEventListener('DOMContentLoaded', function() {
            const toggleSwitch = document.querySelector('.toggle-switch');
            const interpretations = document.querySelectorAll('.interpretation');
            toggleSwitch.addEventListener('click', function() {
                toggleSwitch.classList.toggle('active');
                const showInterpretations = toggleSwitch.classList.contains('active');
                interpretations.forEach(interpretation => {
                    interpretation.style.display = showInterpretations ? 'block' : 'none';
                });
            });
        });
        // Tidbit Tooltip with "Bridge" Anti-Gap Logic
        const tooltip = document.getElementById('tidbit-tooltip');
        const tooltipImg = tooltip.querySelector('.tidbit-tooltip-img');
        const tooltipText = tooltip.querySelector('.tidbit-tooltip-text');
        const tooltipBtn = tooltip.querySelector('.tidbit-tooltip-btn');
        const audio = document.getElementById('tooltip-audio');
        let currentTrigger = null;
        let hideTimeout = null;
        let mouseOverTrigger = false;
        let mouseOverTooltip = false;
        // Position the tooltip right below the trigger
        function positionTooltip(trigger) {
            const rect = trigger.getBoundingClientRect();
            tooltip.style.display = 'flex';
            const tooltipRect = tooltip.getBoundingClientRect();
            const top = rect.bottom + window.scrollY;
            const left = rect.left + window.scrollX + (rect.width - tooltipRect.width) / 2;
            tooltip.style.top = `${top}px`;
            tooltip.style.left = `${left}px`;
        }
        // Position the invisible bridge between trigger and tooltip
        function positionBridge(trigger, tooltip) {
            const bridge = trigger.querySelector('.tidbit-tooltip-bridge');
            if (!bridge) return;
            const triggerRect = trigger.getBoundingClientRect();
            const tooltipRect = tooltip.getBoundingClientRect();
            let distance = tooltipRect.top - triggerRect.bottom;
            if (distance < 0) distance = 0;
            bridge.style.position = "absolute";
            bridge.style.top = (trigger.offsetHeight) + "px";
            bridge.style.height = distance + "px";
            bridge.style.left = 0;
            bridge.style.width = "100%";
            bridge.style.background = "transparent";
            bridge.style.pointerEvents = "auto";
            bridge.style.zIndex = 1999;
        }
        function showTooltip(trigger) {
            clearTimeout(hideTimeout);
            currentTrigger = trigger;
            tooltipImg.src = trigger.getAttribute('data-img') || '';
            tooltipText.textContent = trigger.getAttribute('data-text') || '';
            tooltipBtn.onclick = () => window.open(trigger.getAttribute('data-link') || '#', '_blank');
            const btnPos = trigger.getAttribute('data-btn-pos') || 'bottom';
            tooltipBtn.className = 'tidbit-tooltip-btn btn-' + btnPos;
            tooltip.style.display = 'flex';
            setTimeout(() => tooltip.classList.add('visible'), 10);
            audio.currentTime = 0; audio.play();
            positionTooltip(trigger);
            positionBridge(trigger, tooltip);
            // Always (re-)attach bridge handlers
            const bridge = trigger.querySelector('.tidbit-tooltip-bridge');
            if (bridge) {
                bridge.onmouseenter = function() {
                    mouseOverTrigger = true;
                    clearTimeout(hideTimeout);
                };
                bridge.onmouseleave = function() {
                    mouseOverTrigger = false;
                    setTimeout(() => {
                        if (!mouseOverTrigger && !mouseOverTooltip) hideTooltip();
                    }, 10);
                };
            }
        }
        function hideTooltip() {
            tooltip.classList.remove('visible');
            hideTimeout = setTimeout(() => {
                tooltip.style.display = 'none';
                currentTrigger = null;
            }, 100);
        }
        // Event listeners for all triggers and their bridges
        document.querySelectorAll('.tidbit-tooltip-wrapper').forEach(el => {
            el.addEventListener('mouseenter', function() {
                mouseOverTrigger = true;
                showTooltip(el);
            });
            el.addEventListener('mouseleave', function() {
                mouseOverTrigger = false;
                setTimeout(() => {
                    if (!mouseOverTrigger && !mouseOverTooltip) hideTooltip();
                }, 10);
            });
            // Attach bridge listeners at startup for robustness
            const bridge = el.querySelector('.tidbit-tooltip-bridge');
            if (bridge) {
                bridge.onmouseenter = function() {
                    mouseOverTrigger = true;
                    clearTimeout(hideTimeout);
                };
                bridge.onmouseleave = function() {
                    mouseOverTrigger = false;
                    setTimeout(() => {
                        if (!mouseOverTrigger && !mouseOverTooltip) hideTooltip();
                    }, 10);
                };
            }
        });
        // Tooltip hover handlers
        tooltip.addEventListener('mouseenter', function() {
            mouseOverTooltip = true;
            clearTimeout(hideTimeout);
        });
        tooltip.addEventListener('mouseleave', function() {
            mouseOverTooltip = false;
            setTimeout(() => {
                if (!mouseOverTrigger && !mouseOverTooltip) hideTooltip();
            }, 10);
        });
        // When the tooltip is visible, make sure pointer events are on for all children (fixes unclickable button issue)
        const observer = new MutationObserver(() => {
            if (tooltip.classList.contains('visible')) {
                tooltip.style.pointerEvents = 'auto';
                tooltipBtn.style.pointerEvents = 'auto';
            } else {
                tooltip.style.pointerEvents = 'none';
            }
        });
        observer.observe(tooltip, { attributes: true, attributeFilter: ['class'] });
        // Reposition on scroll/resize (for floating tooltips)
        window.addEventListener('scroll', () => {
            if (currentTrigger && tooltip.classList.contains('visible')) {
                positionTooltip(currentTrigger);
                positionBridge(currentTrigger, tooltip);
            }
        });
        window.addEventListener('resize', () => {
            if (currentTrigger && tooltip.classList.contains('visible')) {
                positionTooltip(currentTrigger);
                positionBridge(currentTrigger, tooltip);
            }
        });
    </script>
</body>
</html>
